# Análisis de la Esperanza de Vida en Diferentes Regiones del Mundo

```{r}
library(readxl)
library(tidyverse)
library(ggplot2)
library(pastecs)
library (fdth)
library(PASWR2)
library(descr)
library(lmtest)
library(dplyr)
library(readr)



ruta_archivo <- "../baseDeDatos/lifeExpectancy.csv"

life_expectancy <- subset(read_csv2(ruta_archivo), Year == 2019)

```

## Antecedentes

La esperanza de vida al nacer es un indicador que refleja la cantidad de años que viviría un recién nacido si las tasas de mortalidad vigentes en el momento de su nacimiento se mantuvieran constantes a lo largo de toda su vida. Este indicador es esencial para evaluar la salud de una población.

## Planteamiento del Problema

Desde el inicio de la industrialización en el siglo XX, la esperanza de vida ha experimentado un notable aumento, y la cifra promedio a nivel mundial se ha más que duplicado, alcanzando los 70 años. Sin embargo, persisten marcadas desigualdades en la esperanza de vida entre distintos países. El estudio realizado por Acemoglu y Johnson ha demostrado la relación entre el incremento de la esperanza de vida y el mejoramiento del crecimiento económico, medido a través del Producto Interno Bruto (PIB) per cápita, controlando los efectos fijos por país. El cuadro que se presenta a continuación ilustra cómo varía la esperanza de vida entre países con ingresos altos y bajos.

## Objetivos

### Objetivo General:

Llevar a cabo un análisis exhaustivo con el propósito de determinar de qué manera la distribución de la riqueza en un país, a través de inversiones en áreas como salud, educación, gestión ambiental y factores socioeconómicos, influye en la esperanza de vida promedio.

### Objetivos Específicos:

1.  Investigar la correlación entre los niveles de ingresos según las regiones y la expectativa de vida en los países.

2.  Evaluar la relación entre el gasto en salud como porcentaje del Producto Interno Bruto (PIB) y los niveles de ingresos de un país.

3.  Analizar cómo el gasto en educación, expresado como porcentaje del PIB, se relaciona con los niveles de ingresos de un país.

4.  Identificar los factores socioeconómicos que ejercen un impacto significativo en la esperanza de vida promedio de un país.

5.  Explorar las conexiones entre las políticas de gestión ambiental, las emisiones de dióxido de carbono y su influencia en la esperanza de vida y los niveles de ingresos de un país.

## Recopilación de Datos

Los datos utilizados en este estudio se obtuvieron de la base de datos en Kaggle titulada "Life expectancy & Socio-Economic (world bank)."

## Población de Estudio

Se analizará la población de diferentes países agrupados en las regiones de "Asia del Este & Pacífico," "Europa & Asia Central," "Medio Oriente & África del Norte," y el "Sub-Sahara Africano."

## Método de Muestreo

(No se proporciona información sobre el método de muestreo en el texto original. Sería conveniente incluir esta información si es relevante).

## Variables de Estudio

### Variables Cuantitativas:

| Variable         | Escala  | Descripción                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|------------|------------|------------------------------------------------|
| Nombre del País  | Nominal | Nombre del país en cuestión                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Código del País  | Nominal | Código del país en cuestión                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Región           | Nominal | Región del mundo en la que se encuentra el país                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Grupo de Ingreso | Ordinal | Nivel de ingresos del país (escala: "High income," "Upper middle income," "Lower middle income," "Low income")                                                                                                                                                                                                                                                                                                                                                                            |
| Año              | Ordinal | Año del registro, desde 2000 hasta 2019                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Corrupción       | Ordinal | CPIA (Country Policy and Institutional Assessment) es un sistema de evaluación utilizado por el Banco Mundial para medir y calificar las políticas y las instituciones de los países en desarrollo. El objetivo del CPIA es proporcionar una evaluación objetiva y comparable de las políticas y las instituciones gubernamentales en áreas clave que afectan al desarrollo económico y social. El rating varía en una escala del 1 al 6, donde 6 implica un buen desempeño del gobierno. |

### Variables Cualitativas:

| Variable                                        | Escala | Descripción                                                                                                                                                                                                                                                                                                                                                                                                  |
|-------------|-------------|----------------------------------------------|
| Prevalencia de la Subnutrición                  | Razón  | La prevalencia de la subnutrición se refiere al porcentaje de la población cuyo consumo habitual de alimentos es insuficiente para mantener una vida normalmente activa y saludable.                                                                                                                                                                                                                         |
| Emisiones de Dióxido de Carbono (Kilotoneladas) | Razón  | Las emisiones de dióxido de carbono provienen de la quema de combustibles fósiles y la producción de cemento, incluyendo el dióxido de carbono generado por la utilización de combustibles sólidos, líquidos y gaseosos, así como la quema de gas.                                                                                                                                                           |
| Gasto Sanitario (% del PIB)                     | Razón  | Nivel de gasto sanitario corriente expresado en porcentaje del PIB, incluyendo los bienes y servicios sanitarios consumidos anualmente. Este indicador excluye los gastos sanitarios de capital, como edificios, maquinaria, tecnología de la información y reservas de vacunas para emergencias o brotes.                                                                                                   |
| Gasto en Educación (% del PIB)                  | Razón  | El gasto de las administraciones públicas en educación, incluyendo gastos corrientes, de capital y transferencias, se expresa como porcentaje del PIB, abarcando los gastos financiados por transferencias de fuentes internacionales al gobierno.                                                                                                                                                           |
| Desempleo (% de la población activa total)      | Razón  | El desempleo se refiere al porcentaje de la población activa que está desempleada, disponible y en búsqueda de empleo.                                                                                                                                                                                                                                                                                       |
| Saneamiento                                     | Razón  | Porcentaje de personas que utilizan instalaciones de saneamiento mejoradas que no comparten con otros hogares y donde los excrementos se eliminan de manera segura in situ o se transportan y tratan fuera del lugar. Las instalaciones mejoradas incluyen sistemas de alcantarillado por tuberías, fosas sépticas, letrinas de pozo mejoradas ventiladas, inodoros compuestos o letrinas de pozo con losas. |
| Esperanza de Vida                               | Razón  | Este indicador se refiere a la cantidad de años que viviría un recién nacido si las tasas de mortalidad actuales al momento de su nacimiento se mantuvieran constantes a lo largo de su vida. En otras palabras, proporciona una perspectiva general de las tasas de mortalidad de la población en un período determinado.                                                                                   |

## Analisis

### Exploracion de datos:

#### Variables cuantitativas:

```{r}
summary_table <- data.frame(
  Variable = c("Prevalencia de Subnutrición", "Emisiones de CO2", "Gasto Sanitario (% del PIB)", 
               "Gasto en Educación (% del PIB)", "Desempleo (% de la población activa total)", "Saneamiento", "Esperanza de Vida"),
  Media = c(mean(life_expectancy$`Prevelance of Undernourishment`, na.rm = TRUE),
            mean(life_expectancy$CO2, na.rm = TRUE),
            mean(life_expectancy$`Health Expenditure %`, na.rm = TRUE),
            mean(life_expectancy$`Education Expenditure %`, na.rm = TRUE),
            mean(life_expectancy$Unemployment, na.rm = TRUE),
            mean(life_expectancy$Sanitation, na.rm = TRUE),
            mean(life_expectancy$`Life Expectancy World Bank`, na.rm = TRUE)),
  Mediana = c(median(life_expectancy$`Prevelance of Undernourishment`, na.rm = TRUE),
              median(life_expectancy$CO2, na.rm = TRUE),
              median(life_expectancy$`Health Expenditure %`, na.rm = TRUE),
              median(life_expectancy$`Education Expenditure %`, na.rm = TRUE),
              median(life_expectancy$Unemployment, na.rm = TRUE),
              median(life_expectancy$Sanitation, na.rm = TRUE),
              median(life_expectancy$`Life Expectancy World Bank`, na.rm = TRUE)),
  Moda = c(table(life_expectancy$`Prevelance of Undernourishment`)[which.max(table(life_expectancy$`Prevelance of Undernourishment`))],
           names(sort(table(life_expectancy$CO2), decreasing = TRUE)[1]),
           table(life_expectancy$`Health Expenditure %`)[which.max(table(life_expectancy$`Health Expenditure %`))],
           table(life_expectancy$`Education Expenditure %`)[which.max(table(life_expectancy$`Education Expenditure %`))],
           table(life_expectancy$Unemployment)[which.max(table(life_expectancy$Unemployment))],
           table(life_expectancy$Sanitation)[which.max(table(life_expectancy$Sanitation))],
           table(life_expectancy$`Life Expectancy World Bank`)[which.max(table(life_expectancy$`Life Expectancy World Bank`))]),
  Desviacion_Estandar = c(sd(life_expectancy$`Prevelance of Undernourishment`, na.rm = TRUE),
                          sd(life_expectancy$CO2, na.rm = TRUE),
                          sd(life_expectancy$`Health Expenditure %`, na.rm = TRUE),
                          sd(life_expectancy$`Education Expenditure %`, na.rm = TRUE),
                          sd(life_expectancy$Unemployment, na.rm = TRUE),
                          sd(life_expectancy$Sanitation, na.rm = TRUE),
                          sd(life_expectancy$`Life Expectancy World Bank`, na.rm = TRUE)),
  CI = c(t.test(life_expectancy$`Prevelance of Undernourishment`, na.rm = TRUE)$conf.int,
        t.test(life_expectancy$CO2, na.rm = TRUE)$conf.int,
        t.test(life_expectancy$`Health Expenditure %`, na.rm = TRUE)$conf.int,
        t.test(life_expectancy$`Education Expenditure %`, na.rm = TRUE)$conf.int,
        t.test(life_expectancy$Unemployment, na.rm = TRUE)$conf.int,
        t.test(life_expectancy$Sanitation, na.rm = TRUE)$conf.int,
        t.test(life_expectancy$`Life Expectancy World Bank`, na.rm = TRUE)$conf.int),
  Max_Value = c(max(life_expectancy$`Prevelance of Undernourishment`, na.rm = TRUE),
                max(life_expectancy$CO2, na.rm = TRUE),
                max(life_expectancy$`Health Expenditure %`, na.rm = TRUE),
                max(life_expectancy$`Education Expenditure %`, na.rm = TRUE),
                max(life_expectancy$Unemployment, na.rm = TRUE),
                max(life_expectancy$Sanitation, na.rm = TRUE),
                max(life_expectancy$`Life Expectancy World Bank`, na.rm = TRUE)),
  Min_Value = c(min(life_expectancy$`Prevelance of Undernourishment`, na.rm = TRUE),
                min(life_expectancy$CO2, na.rm = TRUE),
                min(life_expectancy$`Health Expenditure %`, na.rm = TRUE),
                min(life_expectancy$`Education Expenditure %`, na.rm = TRUE),
                min(life_expectancy$Unemployment, na.rm = TRUE),
                min(life_expectancy$Sanitation, na.rm = TRUE),
                min(life_expectancy$`Life Expectancy World Bank`, na.rm = TRUE))
)
summary_table <- summary_table[1:(nrow(summary_table) - 7), ]

# Mostrar la tabla
View(summary_table)
```

##### Prevalencia De La Subnutrición



```{r}
media_prevalencia_de_subnutricion <- life_expectancy %>%
  group_by(Region) %>%
  summarise(media_prevalencia_de_subnutricion = mean(`Prevelance of Undernourishment`, na.rm = TRUE))

# Crear el gráfico de barras de la media de prevalencia de la subnutricion por regiones
ggplot(media_prevalencia_de_subnutricion, aes(x = Region, y = media_prevalencia_de_subnutricion, fill = Region)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = round(media_prevalencia_de_subnutricion, 2)), vjust = -0.5, size = 3) +  
  labs(x = "Región", y = "Media de prevalencia de la subnutricion", title = "Media de prevalencia de la subnutricion por regiones") +
  theme_minimal()


```

El gráfico representa la prevalencia media de la subnutrición en diferentes regiones del mundo en función de sus respectivas ubicaciones geográficas. Las regiones se dividen en Asia Oriental y Pacífico, Europa y Asia Central, América Latina y el Caribe, Medio Oriente y África del Norte, América del Norte, Asia del Sur y África Subsahariana.

Los datos muestran que la región con la mayor prevalencia de subnutrición es África Subsahariana, con un valor de 16.56 en el eje Y. Por otro lado, la región con la menor prevalencia de subnutrición es América del Norte, con un valor de 3.73 en el mismo eje Y.

Esta información sugiere una variación significativa en la prevalencia de la subnutrición entre las diferentes regiones del mundo. Específicamente, parece que las regiones más empobrecidas, como África Subsahariana, presentan una mayor prevalencia de subnutrición en comparación con las regiones más prósperas, como América del Norte. Esto podría indicar una correlación entre el nivel de riqueza de una región y el estado de nutrición de su población.

##### Emisiones De Dióxido De Carbono (Kilotoneladas)

```{r}

media_co2_por_region <- life_expectancy %>%
  group_by(Region) %>%
  summarise(Media_CO2 = mean(CO2, na.rm = TRUE))

# Crear el gráfico de barras de la media de CO2 por regiones
ggplot(media_co2_por_region, aes(x = Region, y = Media_CO2, fill = Region)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = round(Media_CO2, 2)), vjust = -0.5, size = 3) +
  labs(x = "Región", y = "Media de CO2", title = "Media de Emisiones de CO2 por Regiones") +
  theme_minimal()



```

El gráfico de barras representa las emisiones medias de CO2 por regiones del mundo. En él:

El eje x representa las diferentes regiones geográficas, que incluyen Asia Oriental y Pacífico, Europa y Asia Central, América Latina y el Caribe, Medio Oriente y África del Norte, América del Norte, Asia del Sur y África Subsahariana.

El eje y representa las emisiones medias de CO2 en miles de unidades.

Los datos muestran que la región con las emisiones medias de CO2 más elevadas es Asia Oriental y el Pacífico, seguida de América del Norte y Europa y Asia Central. Por otro lado, las regiones con las emisiones medias de CO2 más bajas son África Subsahariana y Asia del Sur.

Estos resultados indican una marcada variación en las emisiones de CO2 entre las diversas regiones del mundo. En particular, se observa que las regiones más industrializadas, como Asia Oriental y el Pacífico, América del Norte y Europa y Asia Central, presentan mayores emisiones de CO2 en comparación con las regiones menos industrializadas, como África Subsahariana y Asia del Sur. Esto sugiere una correlación entre el grado de industrialización de una región y sus emisiones de CO2.






##### Gasto Sanitario (% del PIB)

```{r}
media_sanitario <- life_expectancy %>%
  group_by(Region) %>%
  summarise(media_sanitario = mean(`Health Expenditure %`, na.rm = TRUE))

# Crear el gráfico de barras de la media de gasto sanitario por regiones
ggplot(media_sanitario, aes(x = Region, y = media_sanitario, fill = Region)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = round(media_sanitario, 2)), vjust = -0.5, size = 3) +  
  labs(x = "Región", y = "Media de Gasto Sanitario", title = "Media de gasto sanitario (% del PIB)por regiones") +
  theme_minimal()

```
El gráfico de barras proporcionado representa el gasto medio en salud como porcentaje del Producto Interno Bruto (PIB) por regiones. En esta interpretación:

El eje x representa las distintas regiones geográficas del mundo, que incluyen Asia Oriental y el Pacífico, Europa y Asia Central, América Latina y el Caribe, Medio Oriente y África del Norte, América del Norte, Asia del Sur y África Subsahariana.

El eje y representa el gasto medio en salud como porcentaje del PIB.

Los datos reflejan que la región con el mayor gasto en salud como porcentaje del PIB es América del Norte, con un valor del 11.17%. Por otro lado, la región con el menor gasto en salud como porcentaje del PIB es Asia del Sur, con un valor del 5.47%.

Estos resultados indican una marcada variación en el gasto en salud entre las diferentes regiones del mundo. Específicamente, se observa que las regiones más acaudaladas, como América del Norte, destinan una proporción significativamente mayor de su PIB al gasto en salud en comparación con las regiones menos acaudaladas, como Asia del Sur. Esto sugiere una correlación entre el nivel de riqueza de una región y su inversión en salud.




##### Gasto en educación (% del PIB)

```{r}
media_educacion <- life_expectancy %>%
  group_by(Region) %>%
  summarise(media_educacion = mean(`Education Expenditure %`, na.rm = TRUE))

# Crear el gráfico de barras de la media de gasto en educacion por regiones
ggplot(media_educacion, aes(x = Region, y = media_educacion, fill = Region)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = round(media_educacion, 2)), vjust = -0.5, size = 3) +  
  labs(x = "Región", y = "Media de gasto en educacion", title = "Media de gasto en educacion (% del PIB) por Regiones") +
  theme_minimal()


```
El gráfico de barras proporcionado representa el gasto promedio en educación como porcentaje del Producto Interno Bruto (PIB) por regiones. En esta interpretación:

El eje x representa las distintas regiones geográficas del mundo, que incluyen Asia Oriental y el Pacífico, Europa y Asia Central, América Latina y el Caribe, Medio Oriente y África del Norte, América del Norte, Asia del Sur y África Subsahariana.

El eje y representa el gasto promedio en educación como porcentaje del PIB.

Los datos reflejan que la región con el mayor gasto en educación como porcentaje del PIB es América del Norte, con un valor del 5.23%. Por otro lado, la región con el menor gasto en educación como porcentaje del PIB es África Subsahariana, con un valor del 4.24%.

Estos resultados indican una marcada variación en el gasto en educación entre las diferentes regiones del mundo. Específicamente, se observa que las regiones más acaudaladas, como América del Norte, destinan una proporción significativamente mayor de su PIB al gasto en educación en comparación con las regiones menos acaudaladas, como África Subsahariana. Esto sugiere una correlación entre el nivel de riqueza de una región y su inversión en educación.



##### Desempleo (% de la población activa total)

```{r}
media_desempleo <- life_expectancy %>%
  group_by(Region) %>%
  summarise(media_desempleo = mean(Unemployment, na.rm = TRUE))

# Crear el gráfico de barras de la media de desempleo por regiones
ggplot(media_desempleo, aes(x = Region, y = media_desempleo, fill = Region)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = round(media_desempleo, 2)), vjust = -0.5, size = 3) + 
  labs(x = "Región", y = "Media de desempleo", title = "Media de desempleo (% de poblacion activa) por Regiones") +
  theme_minimal()



```

El gráfico de barras proporcionado representa la tasa promedio de desempleo en diferentes regiones del mundo. En esta interpretación:

El eje x representa las distintas regiones geográficas del mundo, que incluyen Asia Oriental y el Pacífico, Europa y Asia Central, América Latina y el Caribe, Medio Oriente y África del Norte, América del Norte, Asia del Sur y África Subsahariana.

El eje y representa la tasa promedio de desempleo como porcentaje de la población activa.

Los datos indican que la región con la tasa más alta de desempleo es África Subsahariana, con un valor del 8.21%. Por otro lado, la región con la tasa más baja de desempleo es América del Norte, con un valor del 4.97%.

Estos resultados reflejan una marcada variación en las tasas de desempleo entre las diferentes regiones del mundo. Específicamente, se observa que las regiones menos acaudaladas, como África Subsahariana, experimentan tasas de desempleo más elevadas en comparación con las regiones más prósperas, como América del Norte. Esto sugiere una correlación entre el nivel de riqueza de una región y su tasa de desempleo.



##### Saneamiento

```{r}
media_saneamiento <- life_expectancy %>%
  group_by(Region) %>%
  summarise(media_saneamiento = mean(Sanitation, na.rm = TRUE))

# Crear el gráfico de barras de la media de saneamiento por regiones
ggplot(media_saneamiento, aes(x = Region, y = media_saneamiento, fill = Region)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = round(media_saneamiento, 2)), vjust = -0.5, size = 3) +  
  labs(x = "Región", y = "Media de saneamiento", title = "Media de % de saneamiento por Regiones") +
  theme_minimal()



```

El gráfico de barras proporcionado representa el porcentaje promedio de saneamiento en diferentes regiones del mundo. En esta interpretación:

El eje x representa las distintas regiones geográficas del mundo, que incluyen Asia Oriental y el Pacífico, Europa y Asia Central, América Latina y el Caribe, Medio Oriente y África del Norte, América del Norte, Asia del Sur y África Subsahariana.

El eje y representa el porcentaje promedio de saneamiento.

Los datos muestran que la región con el porcentaje más alto de saneamiento es Europa y Asia Central, con un valor del 77.32%. Por otro lado, la región con el porcentaje más bajo de saneamiento es África Subsahariana, con un valor del 37.38%.

Estos resultados reflejan una marcada variación en los niveles de saneamiento entre las diferentes regiones del mundo. Específicamente, se observa que las regiones más acaudaladas, como Europa y Asia Central, cuentan con un porcentaje significativamente mayor de saneamiento en comparación con las regiones menos acaudaladas, como África Subsahariana. Esto sugiere una correlación entre el nivel de riqueza de una región y su nivel de saneamiento.



##### Esperanza De Vida

```{r}
media_life_expectancy <- life_expectancy %>%
  group_by(Region) %>%
  summarise(media_life_expectancy = mean(`Life Expectancy World Bank`, na.rm = TRUE))

# Crear el gráfico de barras de la media de esperanza de vida por regiones
ggplot(media_life_expectancy, aes(x = Region, y = media_life_expectancy, fill = Region)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = round(media_life_expectancy, 2)), vjust = -0.5, size = 3) +
  labs(x = "Región", y = "Media de esperanza de vida", title = "Media de esperanza de vida por Regiones") +
  theme_minimal()



```

El gráfico de barras proporcionado representa la esperanza de vida media en diferentes regiones del mundo. En esta interpretación:

El eje x representa las distintas regiones geográficas del mundo, que incluyen Asia Oriental y el Pacífico, Europa y Asia Central, América Latina y el Caribe, Medio Oriente y África del Norte, América del Norte, Asia del Sur y África Subsahariana.

El eje y representa la esperanza de vida media en años.

Los datos indican que la región con la mayor esperanza de vida media es Europa y Asia Central, con un valor de 77 años. Sin embargo, no proporcionas información sobre la región con la menor esperanza de vida media, por lo que no es posible determinarla a partir de la descripción que proporcionaste.

Estos resultados sugieren una marcada variación en la esperanza de vida entre las diferentes regiones del mundo. Específicamente, se observa que las regiones más acaudaladas, como Europa y Asia Central, tienen una esperanza de vida más alta en comparación con otras regiones. Esto podría indicar una correlación entre el nivel de riqueza de una región y su esperanza de vida.


#### Variables cualitativas:

##### Region

```{r}
resumen_paises_por_region <- life_expectancy %>%
  group_by(Region) %>%
  summarise(Cantidad_Paises = n())

# Mostrar el resumen
ggplot(resumen_paises_por_region, aes(x = factor(Region), y = Cantidad_Paises)) +
  geom_bar(stat = "identity", fill = "#1f78b4") +
  geom_text(aes(label = Cantidad_Paises), vjust = -0.5, size = 3) +
  labs(x = "Región", y = "Cantidad de Países", title = "Cantidad de Países por región") +
  theme_minimal()


```
El gráfico de barras proporcionado representa la cantidad de países en diferentes regiones del mundo. En esta interpretación:

El eje x representa las distintas regiones geográficas del mundo, que incluyen Asia Oriental y el Pacífico, Europa y Asia Central, América Latina y el Caribe, Medio Oriente y África del Norte, Asia del Sur y África Subsahariana.

El eje y representa la cantidad de países en cada región.

Los datos indican que la región con la mayor cantidad de países es África Subsahariana, con un total de 44 países. Por otro lado, la región con la menor cantidad de países es Medio Oriente y África del Norte, que comprende 3 países.

Estos resultados resaltan una marcada variación en la cantidad de países entre las diferentes regiones del mundo. En particular, se observa que hay más países en las regiones de África Subsahariana y menos en la región de Medio Oriente y África del Norte.






##### Grupo Ingreso

```{r}

life_expectancy$IncomeGroup <- factor(life_expectancy$IncomeGroup, levels = c("Low income", "Lower middle income", "Upper middle income", "High income"))

datos_2019 <- subset(life_expectancy, Year == 2019)

relacion_ingresos_expectativa_vida <- life_expectancy %>%
  group_by(Region, IncomeGroup) %>%
  summarise(Media_Expectativa_Vida = mean(`Life Expectancy World Bank`, na.rm = TRUE))

ggplot(relacion_ingresos_expectativa_vida, aes(x = Region, y = Media_Expectativa_Vida, fill = IncomeGroup)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_fill_manual(values = c("#33a02c","#1f78b4" , "#e31a1c", "#ff7f00"), name = "Income Group") +
  geom_text(aes(label = round(Media_Expectativa_Vida, 2)), position = position_dodge(width = 0.9), vjust = -0.5, size = 3) +
  labs(x = "Región", y = "Expectativa de Vida Media", title = "Relación entre el Ingreso y la expectativa de vida por regiones en el año 2019") +
  theme_minimal() +
  theme(legend.position = "bottom")

```
El gráfico de barras proporcionado muestra la relación entre el grupo de ingresos y la esperanza de vida al nacer en diferentes regiones en el año 2019. En esta interpretación:

El eje x representa los distintos grupos de ingresos, que incluyen ingresos bajos, ingresos medios bajos, ingresos medios altos e ingresos altos.

El eje y representa la esperanza de vida al nacer.

Las regiones incluidas son Asia Oriental y el Pacífico, Europa y Asia Central, América Latina y el Caribe, Medio Oriente y África del Norte, Asia del Sur y África Subsahariana.

Los datos indican que la mayor esperanza de vida se encuentra en Europa y Asia Central para el grupo de ingresos altos, con una esperanza de vida al nacer de 80.09 años. La menor esperanza de vida se encuentra en África Subsahariana para el grupo de ingresos bajos, con una esperanza de vida al nacer de 61.56 años.

Estos resultados sugieren una correlación positiva entre el nivel de ingresos y la esperanza de vida al nacer. En otras palabras, los países con ingresos más altos tienden a presentar una esperanza de vida al nacer más elevada en comparación con los países de ingresos más bajos.


##### Corrupción

```{r}
cantidad_paises_por_corrupcion <- datos_2019 %>%
  group_by(Corruption) %>%
  summarise(Cantidad_Paises = n())

# Mostrar el resultado
ggplot(cantidad_paises_por_corrupcion, aes(x = factor(Corruption), y = Cantidad_Paises)) +
  geom_bar(stat = "identity", fill = "#1f78b4") +
  geom_text(aes(label = Cantidad_Paises), vjust = -0.5, size = 3) +
  labs(x = "Nivel de Corrupción", y = "Cantidad de Países", 
       title = "Cantidad de Países por Nivel de Corrupción en el Año 2019") +
  theme_minimal()
```

El gráfico de barras proporcionado muestra la cantidad de países por nivel de corrupción en el año 2019. En esta interpretación:

El eje x representa los diferentes niveles de corrupción.

El eje y representa la cantidad de países en cada nivel de corrupción.

Los datos indican que el nivel de corrupción con la mayor cantidad de países es el nivel 3, con un total de 129 países. Por otro lado, el nivel de corrupción con la menor cantidad de países es el nivel 4.5, con solo 1 país.

Estos resultados destacan una variación significativa en los niveles de corrupción entre los diferentes países del mundo. Específicamente, se observa que hay una mayor cantidad de países en el nivel 3 de corrupción y una menor cantidad en el nivel 4.5.



### Estimacion muestral:

```{r}

```

## Proporciones
### Proporcion de regiones con bajos ingresos
```{r}
Ingresos <- ifelse(life_expectancy$IncomeGroup== "Low income",1,0)

str(Ingresos)

prop.table(table(Ingresos))

Ingresos <- na.omit(Ingresos)

p <- mean(Ingresos)

p

#Identificar el n

n <- length(Ingresos)
n

#error estandar

error.est.p <- sqrt((p*(1-p))/n)

#cálculo del error
error.p <- 1.96*error.est.p

#limites
lim.inf <- p-error.p
lim.sup <- p+error.p

intervalo.p <- data.frame(n,p,error.est.p,error.p,lim.inf,lim.sup)

intervalo.p 


```


### Proporcion de paises en la categoría de altos ingresos
```{r}
Ingresos <- ifelse(life_expectancy$IncomeGroup== "High income",1,0)

str(Ingresos)

prop.table(table(Ingresos))

Ingresos <- na.omit(Ingresos)

p <- mean(Ingresos)

p

#Identificar el n

n <- length(Ingresos)
n

#error estandar

error.est.p <- sqrt((p*(1-p))/n)

#cálculo del error
error.p <- 1.96*error.est.p

#limites
lim.inf <- p-error.p
lim.sup <- p+error.p

intervalo.p <- data.frame(n,p,error.est.p,error.p,lim.inf,lim.sup)

intervalo.p 

```





##Pruebas de hipótesis

```{r}
curve_area <- function(mean = 0, sd = 1, lb, ub, acolor = "lightgray", ...,z) {
  x <- seq(mean - 3 * sd, mean + 3 * sd, length = 100) 
  
  if (missing(lb)) {
    lb <- min(x)
  }
  if (missing(ub)) {
    ub <- max(x)
  }
  
  x2 <- seq(lb, ub, length = 100)    
  plot(x, dnorm(x, mean, sd), type = "l", ylab = "")
  
  y <- dnorm(x2, mean, sd)
  polygon(c(lb, x2, ub), c(0, y, 0), col = acolor)
  lines(x, dnorm(x, mean, sd), type = "l", ...)
  
  arrows(0, 0.1, z, 0, lwd = 2, length = 0.2)
  text(0, 0.13, z, cex = 1.5)
  
  
}

```



###Hipotesis para la media
Comprobar que en promedio los paises con bajos ingresos tienen menos de 65 años de esperanza de vida
H0:μ$\ge$65
H1:μ<65
```{r}
grupos <- split(life_expectancy, life_expectancy$IncomeGroup)
grupo_low_income <- grupos[["Low income"]]
t.test(grupo_low_income$Life.Expectancy.World.Bank, mu=65,  alternative = "less")
qt (p = 0.95, df = 22, lower.tail = FALSE)
```

Si buscamos el valor crítico de t con un α de 0,05 tenemos que tα=-1.717
Al comparar con el t calculado vemos que este es menor al valor crítico, por lo que decimos que se ubica en la zona de rechazo. Es decir, rechazamos H0
Si utilizamos el valor P para comparar y validar el error de tipo I, vemos que el valor p es de 0.0005817, este es menor al $alpha $ de 0,05, por lo que rechazamos H0Se concluye que en promedio los paises con bajos ingresos tienen menos de 65 años de esperanza de vida.

###Hipotesis para la media
Comprobar que en promedio los paises con altos ingresos tienen más de 70 años de esperanza de vida
H0:μ$\le$70
H1:μ>70
```{r}
grupo_high_income <- grupos[["High income"]]
t.test(grupo_high_income$Life.Expectancy.World.Bank, mu=70,  alternative = "greater")
qt (p = 0.95, df = 56, lower.tail = TRUE)
curve_area(mean = 0, sd = 1, lb = qt (p = 0.95, df = 56, lower.tail = TRUE), lwd = 2, acolor = rgb(0, 0, 1, alpha = 0.5), z=12.77)
```

Si buscamos el valor crítico de t con un α de 0,05 tenemos que tα=1.67
Al comparar con el t calculado vemos que este es mayor al valor crítico, por lo que decimos que se ubica en la zona de rechazo. Es decir, rechazamos H0
Si utilizamos el valor P para comparar y validar el error de tipo I, vemos que el valor p es de 2.2e-16, este es menor al $alpha $ de 0,05, por lo que rechazamos H0
Se concluye que en promedio los paises con altos ingresos tienen más de 70 años de esperanza de vida

###Hipotesis para la proporción
Comprobar que más del 50% de los paises tienen un grado de corrupción 3.
H0:π$\le$0.5
H1:π>0.5
```{r}
conteoX <- sum(life_expectancy$Corruption == "3")
conteoN <- nrow(life_expectancy)
prop.test(x=conteoX, n=conteoN, p=0.5, alternative = "greater", conf.level=0.95, correct=FALSE)
#Valor crítico
qnorm(0.95)
curve_area(mean = 0, sd = 1, lb = qnorm(0.95), lwd = 2, acolor = rgb(0, 0, 1, alpha = 0.5), z=6.36)
```

Al comparar con el valor p vemos se debe rechazar H0, ya que p es menor al valor de alpha. 
Al rechazar la hipótesis nula concluimos que más del 50% de de los paises tienen un grado de corrupción 3.


## Conclusiones
